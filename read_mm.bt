#!/usr/bin/bpftrace

#include <linux/sched.h>

kprobe:do_sys_open
{
	$task = (struct task_struct *)curtask;
	$mm = (struct mm_struct *) $task->mm;
	printf("Some random fields: %lx %lx\n",
		$mm->mmap_base, $mm->start_stack);
}
